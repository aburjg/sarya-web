<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>Sarya</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body>
    <div class="flex justify-center bg-gray-50">
      <div class="h-screen w-full overflow-y-auto md:w-8/12">
        <div class="fixed flex w-full items-center justify-start px-6 py-3 backdrop-blur-xl md:w-8/12">
          <div class="flex h-14 w-14 items-center justify-center rounded-full bg-white">
            <img class="h-8" src="https://mj-cycls.github.io/docusaurus/img/logo.svg" />
          </div>

          <p class="opacity-0">.</p>
          <p class="opacity-0">.</p>
          <p class="opacity-0">.</p>
          <p class="text-xl tracking-wider text-gray-700">Sarya</p>
        </div>

        <div class="fixed bottom-0 z-10 flex w-full justify-center pb-8 md:w-8/12">
          <div class="relative flex w-11/12 items-center justify-center md:w-9/12">
            <textarea id="userInput" placeholder="Send a message" class="w-full resize-none rounded-full border border-gray-200 bg-transparent p-4 backdrop-blur-sm" rows="1" cols="50"></textarea>
            <button id="sendButton" class="absolute inset-y-0 right-0 px-5 text-gray-400">Send</button>
          </div>
        </div>

        <div class="">
          <div class="h-5 bg-gradient-to-r from-pink-200 via-red-300 to-purple-300"></div>

          <p class="opacity-0">.</p>
          <p class="opacity-0">.</p>
          <p class="opacity-0">.</p>
          <p class="opacity-0">.</p>

          <div class="flex items-start p-1 pl-4 opacity-30">
            <div class="p-2">
              <div class="h-8 w-8 rounded-full bg-gradient-to-r from-pink-300 to-purple-400"></div>
            </div>
            <div class="px- rounded-2xl border border-gray-200 p-2">
              <p>Hi Sarya!</p>
              <p>Can you help me with something?</p>
              <p>Thanks ðŸ™Œ</p>
            </div>
          </div>

          <div class="flex items-start p-1 pl-4 opacity-30">
            <div class="p-2">
              <div class="h-8 w-8 rounded-full bg-gradient-to-r from-yellow-200 to-orange-400"></div>
            </div>
            <div class="rounded-2xl border border-gray-200 p-2 px-4">
              <p>What's up? How can I help?</p>
              <p class="pt-2 text-right text-xs text-gray-400">@sarya âœ“</p>
            </div>
          </div>

          <div id="responseArea"></div>


          <p class="opacity-0">.</p>
          <p class="opacity-0">.</p>
          <p class="opacity-0">.</p>
          <p class="opacity-0">.</p>
          <p id="roll" class="opacity-0">.</p>
        </div>
      </div>
    </div>


<script type="text/javascript">
function getQueryParam(param) {
var searchParams = new URLSearchParams(window.location.search);
return searchParams.get(param);
}

// Set the default text in the input field
window.onload = function() {
var defaultText = getQueryParam('text');
if(defaultText) {document.getElementById('userInput').value = defaultText}}

// Global memory for the chat history
var memory={};
document.getElementById('sendButton').addEventListener('click', sendMessage);

function sendMessage(){var userText = document.getElementById('userInput').value;if(!userText.trim()) return; // Don't send empty messages
// Update UI immediately to show the message being sent
addToChat(userText,'You');
var requestData={"dir":"req","body":[{"type":"Text","content":userText}],"meta":memory};
document.getElementById('userInput').value = '';
                       
fetch('https://corsproxy.io/?https://api.sarya.com/', {

method:'POST',headers:{"Accept":"application/json","Content-Type":"application/json","x-version":"2023-06","x-language":"en"},
body:JSON.stringify(requestData),})
.then(response=>response.json())
.then(response=>{response.body.forEach(function(entry){addToChat(entry.content,'Other',entry.type);
});
memory=response.meta;
// document.getElementById('userInput').value = '';
})
.catch(error=>{addToChat("Error occurred.",'Error');
});
}

function addToChat(message,speaker,type="text"){let chatBubble=document.createElement('div');                                              
if(type==="text"){
chatBubble.innerHTML=
`<div class="flex items-start md:w-6/12 p-1 pl-4">
  <div class="p-2">
  ${speaker==='You'?
     '<div class="h-8 w-8 rounded-full bg-gradient-to-r from-pink-300 to-purple-400"></div>':
     '<div class="h-8 w-8 rounded-full bg-gradient-to-r from-yellow-200 to-orange-400"></div>'}
  </div>
  <div class="px- rounded-2xl border border-gray-200 p-2">
    <span>${message}<span>
    <p class="pt-2 text-right text-xs text-gray-400">${speaker==='You'? '@you' : '@marid-name âœ“'}</p>
  </div>
</div>`;}
  
else if(type==="image"){
chatBubble.innerHTML=
`<div class="${speaker==='You'?'text-right':'text-left'}">
<span class="inline-block bg-gray-100 rounded-3xl px-4 py-2 text-sm">
<img class="rounded-xl" src="${message}" alt="">
</span>
</div>`;}
document.getElementById('responseArea').appendChild(chatBubble);
var elementToScrollTo = document.getElementById('roll')
elementToScrollTo.scrollIntoView({behavior:'smooth',block:'nearest',inline:'start'})
}
</script>
</body>
</html>
